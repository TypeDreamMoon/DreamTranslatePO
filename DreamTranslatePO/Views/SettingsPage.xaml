<Page
    x:Class="DreamTranslatePO.Views.SettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    xmlns:anim="using:CommunityToolkit.WinUI.Animations"
    mc:Ignorable="d">
    <Page.Resources>
        <anim:ImplicitAnimationSet x:Name="ShowTransitions">
            <anim:OffsetAnimation EasingMode="EaseOut"
                                  From="0,24,0"
                                  To="0"
                                  Duration="0:0:0.4" />
            <anim:OpacityAnimation EasingMode="EaseOut"
                                   From="0"
                                   To="1"
                                   Duration="0:0:0.2" />
        </anim:ImplicitAnimationSet>
        <anim:ImplicitAnimationSet x:Name="HideTransitions">
            <anim:OffsetAnimation EasingMode="EaseOut"
                                  From="0"
                                  To="0,24,0"
                                  Duration="0:0:0.2" />
            <anim:OpacityAnimation EasingMode="EaseOut"
                                   From="1"
                                   To="0"
                                   Duration="0:0:0.1" />
        </anim:ImplicitAnimationSet>
    </Page.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"></RowDefinition>
            <RowDefinition Height="1*"></RowDefinition>
            <RowDefinition Height="Auto"></RowDefinition>
        </Grid.RowDefinitions>
        <controls:Segmented Name="MainSegmented"
                            Grid.Row="0"
                            SelectedIndex="0"
                            HorizontalAlignment="Stretch">
            <controls:SegmentedItem Tag="Base">基本设置</controls:SegmentedItem>
            <controls:SegmentedItem Tag="Translate">翻译设置</controls:SegmentedItem>
            <controls:SegmentedItem Tag="Misc">其他设置</controls:SegmentedItem>
            <controls:SegmentedItem Tag="About">关于</controls:SegmentedItem>
        </controls:Segmented>

        <controls:SwitchPresenter Grid.Row="1"
                                  Value="{Binding SelectedItem.Tag, ElementName=MainSegmented}"
                                  Name="SwitchPresenter">
            
            <controls:Case Value="Base">
                <ScrollViewer anim:Implicit.HideAnimations="{StaticResource HideTransitions}"
                              anim:Implicit.ShowAnimations="{StaticResource ShowTransitions}">
                    <StackPanel Spacing="20" Padding="20" Orientation="Vertical">

                        <TextBlock Text="提示替换词" FontSize="18" />
                        <TextBox Name="PromptRepWordTextBox" PlaceholderText="输入 提示替换词"></TextBox>
                        
                        <TextBlock Text="提示词" FontSize="18" />
                        <TextBox x:Name="AiPromptBox"
                                 HorizontalAlignment="Stretch"
                                 Height="300"
                                 PlaceholderText="在此输入 AI 提示词…"
                                 TextWrapping="Wrap"
                                 AcceptsReturn="True"/>

                        <TextBlock Text="URL" FontSize="18" />
                        <TextBox x:Name="UrlTextBox" PlaceholderText="输入 API URL" />

                        <TextBlock Text="Model" FontSize="18" />
                        <TextBox x:Name="ModelTextBox" PlaceholderText="输入 Model 名称" />

                        <TextBlock Text="API Key" FontSize="18" />
                        <PasswordBox x:Name="ApiKeyPasswordBox" PlaceholderText="输入 API 密钥" />

                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Spacing="10">
                            <TextBlock Text="启用 Stream" FontSize="18" VerticalAlignment="Center" />
                            <ToggleSwitch x:Name="StreamToggleSwitch" />
                        </StackPanel>

                        <TextBlock Text="最大 Token 数量" FontSize="18" />
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="0.2*" />
                            </Grid.ColumnDefinitions>
                            <Slider x:Name="MaxTokensSlider" Minimum="1" Maximum="4000"
                                    ValueChanged="MaxTokensSlider_OnValueChanged" Grid.Column="0" Padding="5" />
                            <TextBox Name="MaxTokensTextBox" KeyDown="MaxTokensTextBox_OnKeyDown" Grid.Column="1" Padding="5"
                                     VerticalAlignment="Center" />
                        </Grid>

                    </StackPanel>
                </ScrollViewer>
            </controls:Case>
            
            <controls:Case Value="Translate">
                <ScrollViewer anim:Implicit.HideAnimations="{StaticResource HideTransitions}"
                              anim:Implicit.ShowAnimations="{StaticResource ShowTransitions}">
                    <StackPanel Spacing="20" Padding="20" Orientation="Vertical">
                        
                        <TextBlock Text="开发中..." />

                    </StackPanel>
                </ScrollViewer>
            </controls:Case>
            
            <controls:Case Value="Misc">
                <ScrollViewer anim:Implicit.HideAnimations="{StaticResource HideTransitions}"
                              anim:Implicit.ShowAnimations="{StaticResource ShowTransitions}">
                    <StackPanel Spacing="20" Padding="20" Orientation="Vertical">

                        <TextBlock Text="背景模式" FontSize="18" />
                        <ComboBox Name="BackgroundModeComboBox" 
                            SelectionChanged="BackgroundModeComboBox_OnSelectionChanged" HorizontalAlignment="Stretch">
                            <x:String>Mica</x:String>
                            <x:String>MicaAlt</x:String>
                            <x:String>Acrylic</x:String>
                        </ComboBox>
                        
                        <TextBlock Text="背景透明度" FontSize="18" />
                        <Slider x:Name="BackgroundOpacitySlider" Minimum="0" Maximum="100"
                                ValueChanged="BackgroundOpacitySlider_OnValueChanged" />
                    </StackPanel>
                </ScrollViewer>
            </controls:Case>
            
            <controls:Case Value="About">

            </controls:Case>
        </controls:SwitchPresenter>

        <Button Grid.Row="2" Content="保存设置" Click="SaveSettingsButton_Click" HorizontalAlignment="Stretch" Margin="15" />

    </Grid>
</Page>